---
title: 如何在 macOS 上从损坏的档案中恢复文件
description: 修复和从 Mac 上损坏的 ZIP、RAR 和 7z 档案中恢复文件的完整指南。学习修复工具、部分解压技术和预防策略。
keywords: 修复损坏的 zip mac, 修复 rar 文件 mac, mac 损坏档案恢复, 修复损坏的 zip, 恢复损坏的 7z
canonical: https://macpacker.app/zh/docs/corrupted-archives
---

# 如何在 macOS 上从损坏的档案中恢复文件

在下载大文件后遇到损坏的档案或收到损坏的 ZIP、RAR 或 7z 文件可能令人沮丧，特别是当重要数据被困在里面时。档案损坏可能由于下载中断、磁盘错误、存储介质故障或传输问题而发生。幸运的是，许多损坏的档案可以在 macOS 上使用专业工具和技术部分或完全恢复。MacPacker 包含高级错误恢复功能，尝试从损坏的档案中提取尽可能多的数据,通常可以挽救其他工具放弃的文件。

## 了解档案损坏

档案损坏发生在压缩文件的数据结构损坏或不完整时。这可以通过几种方式表现出来：

**头部损坏**——描述档案内容的档案元数据损坏，阻止解压工具读取文件结构。这通常是可以修复的。

**数据损坏**——档案中的单个压缩文件块损坏。某些文件可能可以恢复，而其他文件则完全丢失。

**不完整的档案**——在完成之前中断的下载导致档案文件末尾缺少数据。缺少分段的多部分档案属于此类。

**CRC 错误**——循环冗余校验失败表明提取的数据与预期校验和不匹配，表示压缩或传输期间的损坏。

了解损坏的类型和严重程度有助于确定哪种恢复技术最有可能成功。

## 方法 1：使用 MacPacker 恢复损坏的档案

MacPacker 包含智能错误处理，尝试从损坏的档案中提取尽可能多的数据，即使其他工具完全失败。

### 步骤 1：安装 MacPacker

通过 [Homebrew](https://brew.sh) 安装：

```bash
brew install --cask macpacker
```

或从 [MacPacker 网站](https://macpacker.app/zh#download)或 Mac App Store 下载。

### 步骤 2：打开损坏的档案

双击损坏的档案文件，或右键单击并选择"打开方式 > MacPacker"。即使 Finder 显示错误，MacPacker 仍可能能够读取档案结构。

MacPacker 将分析档案并显示它可以检测到的任何文件，即使档案结构部分损坏。

### 步骤 3：尝试解压

单击**解压**按钮并选择目标文件夹。MacPacker 将：

1. 成功解压所有完整文件
2. 尝试部分恢复损坏的文件
3. 跳过完全损坏的部分，同时继续处理可恢复的数据
4. 提供详细的错误日志，显示哪些文件成功，哪些失败

**主要优势**：与归档实用程序（在遇到错误时完全停止）不同，MacPacker 继续解压所有可恢复的文件，最大化从损坏档案中的数据恢复。

这种部分解压方法通常从中度损坏的档案中恢复 70-90% 的文件，只有最严重损坏的文件才会失败。

### MacPacker 损坏恢复功能

MacPacker 的容错解压处理几种损坏场景：

- **缺少中央目录**——当 ZIP 中央目录损坏时，从本地文件头重建文件列表
- **CRC 不匹配**——即使校验和失败也解压文件，允许您手动评估可用性
- **截断的档案**——解压截断点之前的所有完整文件
- **格式特定恢复**——使用 [RAR 恢复记录](./extract-rar)和 [7z 错误更正](./extract-7zip)（如果可用）

[免费下载 MacPacker](https://macpacker.app/zh#download)

## 方法 2：使用恢复记录修复 RAR 档案

RAR 格式包含一个独特的功能，称为**恢复记录**——在档案创建期间嵌入的可选错误更正数据。如果原始 RAR 文件是使用恢复记录创建的，您可以在 macOS 上修复损坏。

### 使用 unrar 修复命令

安装 `unrar` 命令行工具：

```bash
brew install unrar
```

测试是否存在恢复记录并尝试修复：

```bash
unrar r corrupted-file.rar
```

`r` 命令（修复）分析 RAR 档案，使用校验和检测损坏，并尝试使用恢复记录重建损坏的部分。如果成功，unrar 会创建一个包含修复数据的 `rebuilt.rar` 文件。

**重要提示**：恢复记录必须在最初创建 RAR 文件时添加。由于额外的文件大小开销（通常大 1-10%），在线分发的大多数 RAR 档案不包含恢复记录。

### RAR 修复最有效的情况

RAR 恢复最有效的情况：
- 具有轻微损坏的档案（1-5% 的数据损坏）
- 在创建期间明确启用恢复记录的文件
- 影响数据块而不是档案结构的损坏

对于没有恢复记录的档案，请改用 MacPacker 的部分解压。

## 方法 3：使用终端修复损坏的 ZIP 档案

ZIP 档案不像 RAR 那样包含恢复记录，但 macOS 包含用于尝试修复和提取部分数据的命令行工具。

### 使用 zip -FF 进行抢救模式

`zip` 实用程序包含一个"修复"模式，尝试从损坏的 ZIP 文件中抢救数据：

```bash
zip -FF corrupted.zip --out repaired.zip
```

此命令扫描损坏的档案，尝试重建中央目录，并创建一个包含所有可恢复条目的新修复 ZIP 文件。

### 使用 unzip 进行强制解压

`unzip` 命令可以在遇到错误时强制解压：

```bash
unzip -F corrupted.zip -d output_folder
```

`-F` 标志告诉 unzip 尽管损坏仍尝试解压。对于更激进的恢复，请使用大写 `-FF`：

```bash
unzip -FF corrupted.zip -d output_folder
```

`-FF` 标志更努力地提取数据，使用启发式方法查找文件边界，即使 ZIP 结构严重损坏。

### 了解修复限制

ZIP 修复有重大限制：

- 仅在某些档案结构保持可读时才有效
- 无法恢复物理上缺失的数据（不完整的下载）
- 成功率随着损坏严重程度的增加而降低
- 可能产生名称或扩展名不正确的文件

为了获得最佳结果，请结合多个工具——尝试使用 MacPacker 进行部分解压，然后对 MacPacker 无法恢复的任何文件使用命令行修复。

## 方法 4：验证并重新下载损坏的档案

有时最可靠的恢复方法就是简单地获取档案的干净副本。

### 验证档案完整性

在尝试复杂恢复之前，请验证确实发生了损坏：

**对于 ZIP 文件**：
```bash
unzip -t archive.zip
```

**对于 RAR 文件**：
```bash
unrar t archive.rar
```

**对于 7z 文件**：
```bash
7z t archive.7z
```

这些测试命令在不解压的情况下验证档案完整性，报告特定错误和哪些文件受到影响。

### 重新下载最佳实践

如果完整性测试显示损坏：

1. **检查来源可用性**——如果从网站下载，原始未损坏的文件可能仍然可用
2. **比较文件大小**——损坏的下载通常显示与来源相比不正确的文件大小
3. **验证校验和**——如果来源提供 MD5 或 SHA 校验和，请验证您的下载是否匹配
4. **使用下载恢复**——`curl` 或 `wget` 等工具可以恢复中断的下载，而不是重新开始

对于关键文件，在下载后立即验证校验和以在删除来源之前检测损坏。

## 预防档案损坏

预防比恢复更可靠。遵循这些做法以最小化档案损坏：

### 下载期间

- **使用可靠的下载工具**——现代浏览器和下载管理器包含完整性检查
- **验证校验和**——比较来源提供的 MD5/SHA 哈希
- **检查网络稳定性**——通过不稳定连接的大型下载容易损坏
- **避免中断下载**——不完整的文件可能看起来有效但被截断

### 存储期间

- **监控磁盘健康**——定期运行磁盘工具程序以检查存储错误
- **使用可靠的备份介质**——优质外部驱动器比廉价 USB 驱动器更不容易数据损坏
- **传输后验证**——复制到外部介质或网络存储后始终测试档案
- **保留原始档案**——在验证解压成功之前不要删除源文件

### 创建期间

- **向 RAR 文件添加恢复记录**——创建档案时使用 WinRAR 的恢复记录选项
- **使用错误检测**——创建档案时启用 CRC 验证
- **创建后测试**——在删除源文件之前始终测试新创建的档案
- **考虑[格式选择](./format-comparison)**——带恢复记录的 RAR 提供比 ZIP 更好的损坏抵抗力

## 常见问题

### 所有损坏的档案都可以恢复吗？

不，恢复成功取决于损坏的严重程度和类型。轻微损坏（损坏的头部、少数 CRC 错误）通常可以使用 MacPacker 等工具恢复。严重损坏（缺失数据、多个损坏部分）可能只允许部分恢复或根本无法恢复。带有 RAR 恢复记录的档案具有最高的修复成功率。

### 修复和解压损坏档案有什么区别？

**修复**尝试修复档案结构本身，创建新的有效档案文件（仅在使用 RAR 恢复记录时可能）。**解压**专注于从损坏的档案中抢救尽可能多的数据，而不修复档案本身。MacPacker 专门从事智能解压，即使无法修复也能最大化数据恢复。

### 为什么归档实用程序失败而 MacPacker 成功？

macOS 归档实用程序在遇到任何错误时立即停止解压，假设整个档案不可用。MacPacker 使用容错解压算法，即使出现错误也继续处理，解压所有完整文件，甚至尝试恢复部分损坏的文件。这种方法通常从中度损坏的档案中恢复 70-90% 的数据。

### 如何判断损坏是在下载期间还是存储期间发生的？

将文件大小与来源的预期大小进行比较——截断的文件表示下载不完整。运行完整性测试（`unrar t`、`unzip -t`）以查看特定错误消息。下载损坏通常影响文件末尾，而存储损坏可能影响随机部分。如果可能，重新下载并比较校验和以验证来源。

### 我应该使用 RAR、ZIP 还是 7z 来最小化损坏风险？

启用恢复记录的 [RAR 档案](./extract-rar)提供最佳的损坏抵抗力和修复能力。[ZIP 文件](./password-protect-zip)没有内置恢复机制。[7z 档案](./extract-7zip)提供良好的压缩但有限的恢复选项。对于关键数据，使用带 5-10% 恢复记录的 RAR。对于最大兼容性和适度损坏保护，使用带冗余备份的 ZIP。

### 我可以恢复受密码保护的损坏档案吗？

是的，如果损坏不影响加密头部。如果您有正确的密码，MacPacker 和命令行工具可以从损坏的档案中提取加密文件。但是，影响加密数据块的损坏无法解密或恢复，即使有正确的密码。加密添加了一个额外的层，其中可能发生损坏。

### 下载期间是什么导致档案损坏？

常见原因包括网络数据包丢失、连接中断、代理或 CDN 错误、网络硬件故障和服务器端传输错误。使用下载恢复功能、验证校验和以及在非高峰时段下载可降低损坏风险。对于关键文件，从不同网络下载两次并比较校验和。

---

**需要从损坏的档案中恢复文件吗？**[下载 MacPacker——Mac 的高级错误恢复](https://macpacker.app/zh#download)

即使其他工具失败，MacPacker 的智能解压也会继续恢复数据。免费、开源，支持 30 多种档案格式。
